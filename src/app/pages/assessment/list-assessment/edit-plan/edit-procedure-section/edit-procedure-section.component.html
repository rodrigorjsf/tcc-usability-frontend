<nb-card>
  <nb-card-header>
    <h4>Procedure Section</h4>
  </nb-card-header>
  <nb-card-body>
    <div class="container">
      <div class="col-lg-12 bottom-margin">
        <div
          *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.procedure.acronym).parentQuestions; let i = index;">
          <div class="col-lg-12 row">
            <h4 class="bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
              <nb-icon *ngIf="!isNullOrUndefined(parentQuestion.instruction)"
                       icon="info-outline" class="button-space"
                       [nbTooltip]="parentQuestion.instruction"
                       nbTooltipPlacement="right"
                       nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
            </h4>
          </div>
          <div *ngFor="let question of parentQuestion.questions" style="padding-left: 10px"
               class="container col-lg-12">
            <label class="col-lg-12"><b>{{question.title}}</b>{{question.subTitle}}
              <nb-icon *ngIf="!isNullOrUndefined(question.instruction)"
                       icon="info-outline" class="button-space"
                       [nbTooltip]="question.instruction"
                       nbTooltipPlacement="right"
                       nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
            </label>
            <div *ngIf="question.key === 'PR-18-1'">
              <input nbInput placeholder="Pick Date" [nbDatepicker]="dateTimePicker"
                     [(ngModel)]="assessment.assessmentProcedure.occurDate" >
              <nb-datepicker #dateTimePicker format="yyyy-MM-dd"></nb-datepicker>
              <nb-checkbox [checked]="verifyProcedureState(question.key)"
                           (checkedChange)="checkProcedureQuestion($event, question.key)"
                           style="padding-left: 20px; padding-top: 10px"
                           status="primary"  class="padding-right">Done
              </nb-checkbox>
            </div>
            <div *ngIf="question.key === 'PR-18-2'">
                         <textarea style="padding-left: 10px"
                                   [(ngModel)]="assessment.assessmentProcedure.occurLocal" rows="5"
                                   nbInput fullWidth shape="round"
                                   required="true"
                                   placeholder="Describe where it will take place here" ></textarea>
              <nb-checkbox [checked]="verifyProcedureState(question.key)"
                           (checkedChange)="checkProcedureQuestion($event, question.key)"
                           style="padding-left: 20px; padding-top: 10px"
                           status="primary"  class="padding-right">Done
              </nb-checkbox>
            </div>
            <div *ngIf="question.key === 'PR-18-3'">
                         <textarea style="padding-left: 10px"
                                   [(ngModel)]="assessment.assessmentProcedure.occurDetail" rows="5"
                                   nbInput fullWidth shape="round"
                                   required="true"
                                   placeholder="Describe how it will occur here" ></textarea>
              <nb-checkbox [checked]="verifyProcedureState(question.key)"
                           (checkedChange)="checkProcedureQuestion($event, question.key)"
                           style="padding-left: 20px; padding-top: 10px"
                           status="primary"  class="padding-right">Done
              </nb-checkbox>
            </div>
            <div *ngIf="question.key === 'PR-18-4'">
                         <textarea style="padding-left: 10px"
                                   [(ngModel)]="assessment.assessmentProcedure.occurTime" rows="5"
                                   nbInput fullWidth shape="round"
                                   required="true"
                                   placeholder="Describe how long it will take here" ></textarea>
              <nb-checkbox [checked]="verifyProcedureState(question.key)"
                           (checkedChange)="checkProcedureQuestion($event, question.key)"
                           style="padding-left: 20px; padding-top: 10px"
                           status="primary"  class="padding-right">Done
              </nb-checkbox>
            </div>

            <br>
            <hr class="solid">
          </div>
          <div class="container col-lg-12">
            <div [formGroup]="form" class="col-lg-12 bottom-margin" *ngIf="parentQuestion.key === 'PR-19'">
              <form class='container mt-3' formArrayName="steps">
                <section *ngFor='let step of steps.controls; let i = index;' [formGroupName]="i">
                  <div class='row col-lg-12'>
                    <label>Step Title:</label>
                    <textarea nbInput class='display-next' style="margin-bottom: 10px"
                              id='input-edit-step-name'
                              name='step-name'
                              placeholder='Step title'
                              fullWidth
                              shape="round"
                              formControlName="name"></textarea>
                    <label>Step Description:</label>
                    <textarea nbInput class='display-next'
                              id='input-edit-step-description'
                              name='step-description'
                              placeholder='Step description'
                              fullWidth
                              shape="round"
                              formControlName="description"></textarea>
                    <nb-icon nbButton status="danger" class="display-next" icon="minus-circle-outline"
                             (click)="open(deleteStepDialog)"></nb-icon>
                    <ng-template #deleteStepDialog let-data let-ref="dialogRef">
                      <nb-card accent="warning">
                        <nb-card-body>Do you really want to remove the step?</nb-card-body>
                        <nb-card-footer class="text-center">
                          <button nbButton status="success"
                                  (click)="removeSteps(i);ref.close();">YES
                          </button>
                          <button nbButton status="danger" class="button-space" (click)="ref.close()">NO
                          </button>
                        </nb-card-footer>
                      </nb-card>
                    </ng-template>
                  </div>
                  <hr class="solid">
                </section>
              </form>
              <button nbButton ghost shape='round' size='tiny' status='success' style="margin-bottom: 10px"
                      (click)='addSteps()' >
                <nb-icon icon="plus-circle-outline"></nb-icon>
                Add Step
              </button>
              <nb-checkbox [checked]="verifyProcedureState(parentQuestion.key)"
                           (checkedChange)="checkProcedureQuestion($event, parentQuestion.key)"
                           style="padding-left: 20px; padding-top: 10px"
                           status="primary"  class="padding-right">Done
              </nb-checkbox>
            </div>
            <div class="col-lg-12 bottom-margin" *ngIf="parentQuestion.key === 'PR-20'">
              <nb-select placeholder="Not Selected" style="padding-left: 10px"
                         [(selected)]="assessment.assessmentProcedure.questionsAllowed">
                <nb-option *ngFor="let option of genericSelectOptions.options" [value]="option.value"
                           >{{ option.label }}</nb-option>
              </nb-select>
              <nb-checkbox [checked]="verifyProcedureState(parentQuestion.key)"
                           (checkedChange)="checkProcedureQuestion($event, parentQuestion.key)"
                           style="padding-left: 20px; padding-top: 10px"
                           status="primary"  class="padding-right">Done
              </nb-checkbox>
            </div>
            <div class="col-lg-12 bottom-margin" *ngIf="parentQuestion.key === 'PR-21'">
              <nb-radio-group  class="row bottom-margin"
                              [(ngModel)]="assessment.assessmentProcedure.isPilotAssessment">
                <nb-radio
                  *ngFor="let option of genericSelectOptions.options"
                  [value]="option.value">
                  {{ option.label }}
                </nb-radio>
              </nb-radio-group>
              <div *ngIf="!isNullOrUndefinedOrFalse(assessment.assessmentProcedure.isPilotAssessment)">
                <label>Description:</label>
                <textarea style="padding-left: 10px"
                          [(ngModel)]="assessment.assessmentProcedure.pilotDescription" rows="5"
                          nbInput fullWidth shape="round"
                          required="true"
                          placeholder="Describe how will be conducted here"
                          [hidden]="!assessment.assessmentProcedure.isPilotAssessment"></textarea>
              </div>
              <nb-checkbox [checked]="verifyProcedureState(parentQuestion.key)"
                           (checkedChange)="checkProcedureQuestion($event, parentQuestion.key)"
                           style="padding-left: 20px; padding-top: 10px"
                           status="primary"  class="padding-right">Done
              </nb-checkbox>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nb-card-body>
  <nb-card-footer>
    <div>
      <button nbButton class="padding-right" (click)="onSubmit()" status="success">
        <b>SUBMIT</b>
      </button>
    </div>
  </nb-card-footer>
</nb-card>
