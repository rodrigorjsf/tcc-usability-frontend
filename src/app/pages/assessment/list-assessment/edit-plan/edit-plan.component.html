<div *ngIf="dataloaded | async" class="container">
  <div class="col-lg-12">
    <h3>
      Edit Assessment Plan
    </h3>
    <nb-card accent="warning">
      <nb-card-header><b>READ BEFORE FILLING OUT THE PLAN</b></nb-card-header>
      <nb-card-body>
        For reasons of integrity control and progress of the planning result, after
        filling each question with the final answer, it is necessary to check the <b>"Done" checkbox</b>.<br><br>
        Each question has its own corresponding <b>"Done" checkbox</b>. Usually located below or to the right of the
        answer.<br><br>
        <label style="padding-left: 10px">What it looks like: <br>
          <nb-checkbox status="primary">Done</nb-checkbox>
        </label><br>
        <hr class="solid">
        To start filling out the evaluation plan, it is necessary to click on the <b>"Edit Section"</b>
        button located at the top right of each section.<br><br>
        <label style="padding-left: 10px">What it looks like: <br><br>
          <button class="fa-pull-right padding-right" size="medium" nbButton ghost
                  status="success">
            <nb-icon icon="edit-2-outline"></nb-icon>
            EDIT SECTION
          </button>
        </label><br>
      </nb-card-body>
    </nb-card>
    <nb-card>
      <nb-card-header><b>PLAN SECTIONS</b></nb-card-header>
      <nb-card-body class="example-items-col">
        <nb-card>
          <nb-card-header style="background-color: #206ea1">
            <label><b>Assessment Plan Progress</b></label>
          </nb-card-header>
          <nb-card-body class="example-items-col">
            <div class="row col-lg-12 bottom-margin">
              <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="planPercentage"
                               [status]="getPlanPercentageColor()"
                               [displayValue]="true"></nb-progress-bar>
              <label *ngIf="planPercentage === 0">0%</label>
            </div>
          </nb-card-body>
        </nb-card>
        <nb-accordion multi>
          <nb-accordion-item (click)="onClickApplication(categories.application.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.application.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success" (click)="onEditApplication()">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(getApplicationAcronym()).parentQuestions; let i = index;">
                    <h4 class="col-lg-12 bottom-margin"><b>{{parentQuestion.title}}</b></h4>

                    <div *ngFor="let question of parentQuestion.questions" style="padding-left: 10px"
                         class="container col-lg-12 bottom-margin">
                      <label *ngIf="question.objKey != 'PERC'; else percentage;"
                             class="col-lg-10"><b>{{question.title}}</b>{{question.subTitle}}</label>
                      <div *ngIf="isFirstQuestion(question.objKey); else applicationSectionRadioButtons;"
                           class="container">
                        <div *ngIf="question.objKey == 'AP-PN'" class="col-lg-12 bottom-margin">
                          <input style="padding-left: 10px" [(ngModel)]="assessment.projectName" type="text" nbInput
                                 fullWidth required="true" readonly>
                          <nb-checkbox
                            [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.projectName)"
                            (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.projectName)"
                            status="primary" disabled>Done
                          </nb-checkbox>
                        </div>

                        <div *ngIf="question.objKey === 'AP-PD'" class="col-lg-12 bottom-margin">
                          <textarea style="padding-left: 10px" [(ngModel)]="assessment.projectDescription" rows="5"
                                    nbInput fullWidth shape="round"
                                    required="true"
                                    placeholder="Describe your project" readonly></textarea>
                          <nb-checkbox
                            [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.projectDescription)"
                            (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.projectDescription)"
                            style="padding-left: 20px; padding-top: 10px"
                            status="primary" disabled="true">Done
                          </nb-checkbox>
                        </div>
                      </div>
                      <ng-template #percentage>
                        <div *ngIf="!isNull(assessment.smartCityPercentage)" class="col-lg-12 bottom-margin">
                          <label class="col-lg-4 vertical-center"><b>{{question.title}}</b></label>
                          <h6 style="padding-left: 10px" style="color: #3c763d">{{assessment.smartCityPercentage}}%</h6>
                        </div>
                      </ng-template>
                      <ng-template #applicationSectionRadioButtons>
                        <div class="container" style="padding-left: 10px">
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="isDataManagement(question.objKey);"
                                     [(selected)]="assessment.smartCityQuestionnaire.hasDataManagement">
                            <nb-option *ngFor="let option of selectOptions.dataManagement" [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox *ngIf="isDataManagement(question.objKey);"
                                       [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.dataManagement)"
                                       (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.dataManagement)"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="question.objKey === smartCityCategories.applicationExecutionEnvironment.acronym;"
                                     [(selected)]="assessment.smartCityQuestionnaire.hasAppExecution">
                            <nb-option *ngFor="let option of selectOptions.applicationExecutionEnvironment"
                                       [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox
                            *ngIf="question.objKey === smartCityCategories.applicationExecutionEnvironment.acronym;"
                            [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.applicationExecution)"
                            (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.applicationExecution)"
                            status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="question.objKey === smartCityCategories.sensorNetworkManagement.acronym;"
                                     [(selected)]="assessment.smartCityQuestionnaire.hasSensorNetwork">
                            <nb-option *ngFor="let option of selectOptions.sensorNetworkManagement"
                                       [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox *ngIf="question.objKey === smartCityCategories.sensorNetworkManagement.acronym;"
                                       [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.sensorNetwork)"
                                       (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.sensorNetwork)"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="question.objKey === smartCityCategories.dataProcessing.acronym;"
                                     [(selected)]="assessment.smartCityQuestionnaire.hasDataProcessing">
                            <nb-option *ngFor="let option of selectOptions.dataProcessing" [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox *ngIf="question.objKey === smartCityCategories.dataProcessing.acronym;"
                                       [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.dataProcessing)"
                                       (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.dataProcessing)"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="question.objKey === smartCityCategories.dataAccess.acronym;"
                                     [(selected)]="assessment.smartCityQuestionnaire.hasDataAccess">
                            <nb-option *ngFor="let option of selectOptions.dataAccess" [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox *ngIf="question.objKey === smartCityCategories.dataAccess.acronym;"
                                       [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.dataAccess)"
                                       (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.dataAccess)"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="question.objKey === smartCityCategories.serviceManagement.acronym;"
                                     [(selected)]="assessment.smartCityQuestionnaire.hasServiceManagement">
                            <nb-option *ngFor="let option of selectOptions.serviceManagement" [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox *ngIf="question.objKey === smartCityCategories.serviceManagement.acronym;"
                                       [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.serviceManagement)"
                                       (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.serviceManagement)"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="question.objKey === smartCityCategories.toolsforSoftwareDevelopment.acronym;"
                                     [(selected)]="assessment.smartCityQuestionnaire.hasSoftwareTools">
                            <nb-option *ngFor="let option of selectOptions.toolsforSoftwareDevelopment"
                                       [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox
                            *ngIf="question.objKey === smartCityCategories.toolsforSoftwareDevelopment.acronym;"
                            [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.tools)"
                            (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.tools)"
                            status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                     *ngIf="question.objKey === smartCityCategories.definingACityModel.acronym;"
                                     [(selected)]="assessment.smartCityQuestionnaire.defineCityModel">
                            <nb-option [value]="null" disabled="true">Not Selected</nb-option>
                            <nb-option *ngFor="let option of selectOptions.definingACityModel" [value]="option.value"
                                       disabled="true">{{ option.label }}</nb-option>
                          </nb-select>
                          <nb-checkbox *ngIf="question.objKey === smartCityCategories.definingACityModel.acronym;"
                                       [checked]="ApplicationSectionCheckboxStatus(assessment.answers.planApplicationAnswers.definingCityModel)"
                                       (checkedChange)="checkApplicationSection($event, question.objKey, assessment.answers.planApplicationAnswers.definingCityModel)"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                          <hr class="solid">
                        </div>
                      </ng-template>
                    </div>
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
          <nb-accordion-item (click)="onClickApplication(categories.goals.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.goals.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success" (click)="onEditGoals()">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.goals.acronym).parentQuestions; let i = index;">
                    <div class="col-lg-12 row">
                      <h4 class="bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
                        <nb-icon icon="info-outline" class="button-space"
                                 [nbTooltip]="parentQuestion.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </h4>
                    </div>
                    <div *ngFor="let question of parentQuestion.questions" style="padding-left: 10px"
                         class="container col-lg-12">
                      <label class="col-lg-12"><b>{{question.title}}</b>{{question.subTitle}}</label>

                      <div *ngFor="let usabilityGoal of assessment.usabilityGoals" class="col-lg-12 bottom-margin">
                          <textarea *ngIf="isEqual(question.objectKey, usabilityGoal.attribute)"
                                    style="padding-left: 10px"
                                    [(ngModel)]="usabilityGoal.goal" rows="5"
                                    nbInput fullWidth shape="round"
                                    required="true"
                                    placeholder="Describe the goals here" readonly></textarea>
                        <nb-checkbox *ngIf="isEqual(question.objectKey, usabilityGoal.attribute)"
                                     [checked]="verifyGoalsCheckState(usabilityGoal)"
                                     (checkedChange)="checkUsabilityGoal($event, usabilityGoal)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <br>
                      <hr class="solid">
                    </div>
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
          <nb-accordion-item (click)="onClickApplication(categories.variables.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.variables.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success" (click)="onEditVariables()">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.variables.acronym).parentQuestions; let i = index;">
                    <div class="col-lg-12 row">
                      <h4 class="col-lg-12 bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
                        <nb-icon *ngIf="!isNullOrUndefined(parentQuestion.instruction)" icon="info-outline"
                                 class="button-space"
                                 [nbTooltip]="parentQuestion.instruction" style="padding-left: 5px"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </h4>
                    </div>
                    <div *ngFor="let question of parentQuestion.questions" style="padding-left: 10px"
                         class="container col-lg-12 bottom-margin">
                      <label class="col-lg-12"><b>{{question.title}}</b>{{question.subTitle}}</label>
                      <div *ngIf="parentQuestion.key === 'VM-4'" class="container">
                        <div *ngFor="let variable of assessment.variables" class="col-lg-12 bottom-margin">
                          <textarea *ngIf="isEqual(question.objectKey, variable.usabilityAttribute)"
                                    style="padding-left: 10px"
                                    [(ngModel)]="variable.variables" rows="2"
                                    nbInput fullWidth shape="round"
                                    placeholder="Describe the attribule variables here" readonly></textarea>
                          <nb-checkbox *ngIf="isEqual(question.objectKey, variable.usabilityAttribute)"
                                       [checked]="verifyUsabilityVariableCheck(variable.usabilityAttribute, parentQuestion.key)"
                                       (checkedChange)="checkUsabilityVariable($event, variable.usabilityAttribute, parentQuestion.key)"
                                       style="padding-left: 20px; padding-top: 10px"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                        </div>
                      </div>
                      <div class="container" *ngIf="parentQuestion.key === 'VM-5'">
                        <div *ngFor="let variable of assessment.variables" class="col-lg-12 bottom-margin">
                        <textarea *ngIf="isEqual(question.objectKey, variable.usabilityAttribute)"
                                  style="padding-left: 10px"
                                  [(ngModel)]="variable.obtainedBy" rows="2"
                                  nbInput fullWidth shape="round"
                                  placeholder="Describe the methods and criteria here" readonly></textarea>
                          <nb-checkbox *ngIf="isEqual(question.objectKey, variable.usabilityAttribute)"
                                       [checked]="verifyUsabilityVariableCheck(variable.usabilityAttribute, parentQuestion.key)"
                                       (checkedChange)="checkUsabilityVariable($event, variable.usabilityAttribute, parentQuestion.key)"
                                       style="padding-left: 20px; padding-top: 10px"
                                       status="primary" disabled="true" class="padding-right">Done
                          </nb-checkbox>
                        </div>
                      </div>
                      <br>
                      <hr class="solid">
                    </div>
                    <div class="container" *ngIf="parentQuestion.key === 'VM-6'">
                      <nb-card>
                        <nb-card-body class="form-group">
                          <div *ngFor="let scale of usabilityScales;let i = index;" class="row">
                            <nb-checkbox [checked]="verifyScaleStatus(scale)"
                                         (checkedChange)="scaleSelectionCheckbox($event,scale,i)"
                                         style="padding-left: 20px"
                                         status="primary" disabled="true">
                              <nb-action class="button-space"
                                         [nbTooltip]="scale.description"
                                         nbTooltipPlacement="right"
                                         nbTooltipStatus="info" nbButton status="info">{{scale.name}} ({{scale.acronym}}
                                )
                              </nb-action>
                            </nb-checkbox>
                          </div>
                          <nb-checkbox [checked]="verifyScalesCheckbox()"
                                       (checkedChange)="checkScalesCheckbox($event)"
                                       style="padding-left: 20px; padding-top: 10px"
                                       status="primary" [disabled]="checkClickable()" class="padding-right"
                                       nbTooltip="It is necessary to choose at least one option."
                                       nbTooltipPlacement="top"
                                       [nbTooltipTrigger]="tooltipTrigger"
                                       nbTooltipStatus="danger" nbButton status="danger">Done
                          </nb-checkbox>
                        </nb-card-body>
                      </nb-card>
                    </div>
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
          <nb-accordion-item (click)="onClickApplication(categories.participants.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.participants.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success" (click)="onEditParticipant()">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.participants.acronym).parentQuestions; let i = index;">
                    <div class="col-lg-12 row">
                      <label class="bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
                        <nb-icon *ngIf="!isNullOrUndefined(parentQuestion.instruction)" icon="info-outline"
                                 class="button-space"
                                 [nbTooltip]="parentQuestion.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </label>
                    </div>
                    <div class="bottom-margin-light" *ngIf="parentQuestion.key === 'PA-7'">
                      <input class="col-lg-3" style="padding-left: 10px" [ngModel]="assessment.participant.participantsQuantity"
                             type="number" nbInput
                             fullWidth required="true" placeholder="Enter the quantity" readonly>
                      <nb-checkbox [checked]="verifyParticipantState(parentQuestion.key)"
                                   (checkedChange)="checkParticipantQuestion($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary"  class="padding-right" disabled>Done
                      </nb-checkbox>
                    </div>
                    <div *ngIf="parentQuestion.key === 'PA-8'">
                      <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                 [(selected)]="assessment.participant.participationLocalType">
                        <nb-option value="P" disabled="true">IN PERSON</nb-option>
                        <nb-option value="R" disabled="true">REMOTE</nb-option>
                      </nb-select>
                      <nb-checkbox [checked]="verifyParticipantState(parentQuestion.key)"
                                   (checkedChange)="checkParticipantQuestion($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary"  class="padding-right" disabled>Done
                      </nb-checkbox>
                    </div>
                    <div class="bottom-margin-light" *ngIf="parentQuestion.key === 'PA-9'">
                      <textarea style="padding-left: 10px"
                                nbInput fullWidth shape="round"
                                [(ngModel)]="assessment.participant.compensationDescription"
                                placeholder="Describe the compesations here" readonly></textarea>
                      <nb-checkbox [checked]="verifyParticipantState(parentQuestion.key)"
                                   (checkedChange)="checkParticipantQuestion($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary"  class="padding-right" disabled>Done
                      </nb-checkbox>
                    </div>
                    <div class="bottom-margin-light" *ngIf="parentQuestion.key === 'PA-10'">
                      <textarea style="padding-left: 10px"
                                nbInput fullWidth shape="round"
                                [(ngModel)]="assessment.participant.criteria"
                                placeholder="Describe the eligibility criteria here" readonly></textarea>
                      <nb-checkbox [checked]="verifyParticipantState(parentQuestion.key)"
                                   (checkedChange)="checkParticipantQuestion($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary"  class="padding-right" disabled>Done
                      </nb-checkbox>
                    </div>
                    <div class="bottom-margin-light" *ngIf="parentQuestion.key === 'PA-11'">
                      <nb-select class="bottom-margin-light" placeholder="Not Selected" style="padding-left: 10px"
                                 [(selected)]="assessment.participant.hasCollectedInformation">
                        <nb-option *ngFor="let option of genericSelectOptions.options"
                                   [value]="option.value">{{option.label}}</nb-option>
                      </nb-select>
                      <textarea style="padding-left: 10px"
                                nbInput fullWidth shape="round"
                                placeholder="Describes data usage here"
                                [(ngModel)]="assessment.participant.collectedInformationUse"
                                [disabled]="!assessment.participant.hasCollectedInformation" readonly></textarea>
                      <nb-checkbox [checked]="verifyParticipantState(parentQuestion.key)"
                                   (checkedChange)="checkParticipantQuestion($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary"  class="padding-right" disabled>Done
                      </nb-checkbox>
                    </div>
                    <div class="bottom-margin-light" *ngIf="parentQuestion.key === 'PA-12'">
                      <textarea style="padding-left: 10px"
                                nbInput fullWidth shape="round"
                                [(ngModel)]="assessment.participant.instructions"
                                placeholder="Describes instructions here" readonly></textarea>
                      <nb-checkbox [checked]="verifyParticipantState(parentQuestion.key)"
                                   (checkedChange)="checkParticipantQuestion($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary"  class="padding-right" disabled>Done
                      </nb-checkbox>
                    </div>
                    <div [formGroup]='form' class="bottom-margin-light" *ngIf="parentQuestion.key === 'PA-13'">
                      <label *ngIf="assessment.participant.questions.length === 0">N/A</label>
                      <form class='container mt-3' formArrayName="questions">
                        <section *ngFor='let question of questions.controls; let i = index;' [formGroupName]="i">
                          <div class='row col-lg-8'>
                            <textarea nbInput class='display-next'
                                      id='input-question'
                                      name='question'
                                      placeholder='New question'
                                      fullWidth
                                      shape="round"
                                      formControlName="question"></textarea>
                            <nb-icon nbButton status="danger" class="display-next" icon="minus-circle-outline"
                                     (click)="open(deleteQuestionDialog)"></nb-icon>
                            <ng-template #deleteQuestionDialog let-data let-ref="dialogRef">
                              <nb-card accent="warning">
                                <nb-card-body>Do you really want to remove the question?</nb-card-body>
                                <nb-card-footer class="text-center">
                                  <button nbButton status="success"
                                          (click)="removeQuestion(i);ref.close();">YES
                                  </button>
                                  <button nbButton status="danger" class="button-space" (click)="ref.close()">NO
                                  </button>
                                </nb-card-footer>
                              </nb-card>
                            </ng-template>
                          </div>
                        </section>
                      </form>
                      <button nbButton ghost shape='round' size='tiny' status='success' class='top-margin'
                              (click)='addQuestion()' hidden>
                        <nb-icon icon="plus-circle-outline"></nb-icon>
                        Add Question
                      </button>
                      <nb-checkbox [checked]="verifyParticipantState(parentQuestion.key)"
                                   (checkedChange)="checkParticipantQuestion($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary"  class="padding-right" disabled>Done
                      </nb-checkbox>
                    </div>
                    <br>
                    <hr class="solid">
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
          <nb-accordion-item (click)="onClickApplication(categories.tasks.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.tasks.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success" (click)="onEditTools()">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.tasks.acronym).parentQuestions; let i = index;">
                    <div class="col-lg-12 row">
                      <label class="bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
                        <nb-icon *ngIf="!isNullOrUndefined(parentQuestion.instruction)" icon="info-outline"
                                 class="button-space"
                                 [nbTooltip]="parentQuestion.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </label>
                    </div>
                    <div class="bottom-margin-light" *ngIf="parentQuestion.key === 'TM-14'">
                      <nb-card [formGroup]='form'>
                        <nb-card-body class="row">
                          <label *ngIf="!checkIfToolsIsNotEmpty()">N/A</label>
                          <form class='container mt-3' formArrayName="tools">
                            <section *ngFor='let tool of tools.controls; let i = index;' [formGroupName]="i">
                              <div class='row col-lg-8'>
                            <textarea nbInput class='display-next'
                                      id='input-tool'
                                      name='tool'
                                      placeholder='New instruments, materials, technology, or tool'
                                      fullWidth
                                      shape="round"
                                      formControlName="tool"></textarea>
                                <nb-icon nbButton status="danger" class="display-next" icon="minus-circle-outline"
                                         (click)="open(deleteToolDialog)"></nb-icon>
                                <ng-template #deleteToolDialog let-data let-ref="dialogRef">
                                  <nb-card accent="warning">
                                    <nb-card-body>Do you really want to remove the tool?</nb-card-body>
                                    <nb-card-footer class="text-center">
                                      <button nbButton status="success"
                                              (click)="removeTool(i);ref.close();">YES
                                      </button>
                                      <button nbButton status="danger" class="button-space" (click)="ref.close()">NO
                                      </button>
                                    </nb-card-footer>
                                  </nb-card>
                                </ng-template>
                              </div>
                            </section>
                          </form>
                          <button nbButton ghost shape='round' size='tiny' status='success' class="top-margin"
                                  (click)='addTools()' disabled>
                            <nb-icon icon="plus-circle-outline"></nb-icon>
                            Add Tool
                          </button>
                        </nb-card-body>
                      </nb-card>
                      <span *ngIf="checkIfToolsIsNotEmpty()">
                         <label>Description:</label>
                      <textarea style="padding-left: 10px"
                                nbInput fullWidth shape="round"
                                [(ngModel)]="assessment.assessmentTools.toolsUsageDescription"
                                placeholder="Describe their usage here" readonly></textarea>
                      </span>
                      <nb-checkbox checked="false"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary" disabled="true" class="padding-right">Done
                      </nb-checkbox>
                    </div>
                    <div class="bottom-margin-light"
                         *ngIf="parentQuestion.key === 'TM-15' || parentQuestion.key === 'TM-16'
                         || parentQuestion.key === 'TM-17'">
                      <nb-card [formGroup]='form'>
                        <nb-card-body class="row">
                          <label *ngIf="!checkIfTasksIsNotEmpty()">N/A</label>
                          <form class='container mt-3' formArrayName="tasks">
                            <section *ngFor='let task of tasks.controls; let i = index;' [formGroupName]="i">
                              <div *ngIf="parentQuestion.key === 'TM-15'" class='row col-lg-8'>
                                <textarea nbInput class='display-next'
                                          id='input-task-description'
                                          name='task-description'
                                          placeholder='Describe the task'
                                          fullWidth
                                          shape="round"
                                          formControlName="description"></textarea>
                                <nb-icon nbButton status="danger" class="display-next" icon="minus-circle-outline"
                                         (click)="open(deleteTaskDialog)"></nb-icon>
                                <ng-template #deleteTaskDialog let-data let-ref="dialogRef">
                                  <nb-card accent="warning">
                                    <nb-card-body>Do you really want to remove the task?</nb-card-body>
                                    <nb-card-footer class="text-center">
                                      <button nbButton status="success"
                                              (click)="removeTask(i);ref.close();">YES
                                      </button>
                                      <button nbButton status="danger" class="button-space" (click)="ref.close()">NO
                                      </button>
                                    </nb-card-footer>
                                  </nb-card>
                                </ng-template>
                              </div>
                              <div *ngIf="parentQuestion.key === 'TM-16'" class='row col-lg-12'>
                                <label>{{i + 1}}. {{getTaskDescription(i)}}</label>
                                <input nbInput class='display-next'
                                       id='input-edit-task-execution'
                                       name='task-execution'
                                       placeholder='Insert the task execution time (in minutes)'
                                       fullWidth
                                       formControlName="taskExecutionTime">
                              </div>
                              <div *ngIf="parentQuestion.key === 'TM-17'" class='row col-lg-12'>
                                <label>{{i + 1}}. {{getTaskDescription(i)}}</label>
                                <input nbInput class='display-next'
                                       id='input-task-acceptance-criteria'
                                       name='task-acceptance-criteria'
                                       placeholder='Insert the task acceptance criteria'
                                       fullWidth
                                       formControlName="acceptanceCriteria">
                              </div>
                            </section>
                          </form>
                          <button *ngIf="parentQuestion.key === 'TM-15'" nbButton ghost shape='round'
                                  size='tiny' status='success' class="top-margin"
                                  (click)='addTasks()' disabled>
                            <nb-icon icon="plus-circle-outline"></nb-icon>
                            Add Task
                          </button>
                        </nb-card-body>
                      </nb-card>
                      <nb-checkbox [checked]="verifyMaterialsCheckState(parentQuestion.key)"
                                   (checkedChange)="checkMaterial($event, parentQuestion.key)"
                                   style="padding-left: 20px; padding-top: 10px"
                                   status="primary" disabled="true" class="padding-right">Done
                      </nb-checkbox>
                    </div>
                    <br>
                    <hr class="solid">
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
          <nb-accordion-item (click)="onClickApplication(categories.procedure.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.procedure.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success" (click)="onEditProcedure()">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.procedure.acronym).parentQuestions; let i = index;">
                    <div class="col-lg-12 row">
                      <h4 class="bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
                        <nb-icon *ngIf="!isNullOrUndefined(parentQuestion.instruction)"
                                 icon="info-outline" class="button-space"
                                 [nbTooltip]="parentQuestion.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </h4>
                    </div>
                    <div *ngFor="let question of parentQuestion.questions" style="padding-left: 10px"
                         class="container col-lg-12">
                      <label class="col-lg-12"><b>{{question.title}}</b>{{question.subTitle}}
                        <nb-icon *ngIf="!isNullOrUndefined(question.instruction)"
                                 icon="info-outline" class="button-space"
                                 [nbTooltip]="question.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </label>
                      <div *ngIf="question.key === 'PR-18-1'">
                        <input nbInput placeholder="Pick Date" [nbDatepicker]="dateTimePicker"
                               [(ngModel)]="assessment.assessmentProcedure.occurDate" disabled>
                        <nb-datepicker #dateTimePicker format="yyyy-MM-dd"></nb-datepicker>
                        <nb-checkbox [checked]="verifyProcedureState(question.key)"
                                     (checkedChange)="checkProcedureQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div *ngIf="question.key === 'PR-18-2'">
                         <textarea style="padding-left: 10px"
                                   [(ngModel)]="assessment.assessmentProcedure.occurLocal" rows="5"
                                   nbInput fullWidth shape="round"
                                   required="true"
                                   placeholder="Describe where it will take place here" readonly></textarea>
                        <nb-checkbox [checked]="verifyProcedureState(question.key)"
                                     (checkedChange)="checkProcedureQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div *ngIf="question.key === 'PR-18-3'">
                         <textarea style="padding-left: 10px"
                                   [(ngModel)]="assessment.assessmentProcedure.occurDetail" rows="5"
                                   nbInput fullWidth shape="round"
                                   required="true"
                                   placeholder="Describe how it will occur here" readonly></textarea>
                        <nb-checkbox [checked]="verifyProcedureState(question.key)"
                                     (checkedChange)="checkProcedureQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div *ngIf="question.key === 'PR-18-4'">
                         <textarea style="padding-left: 10px"
                                   [(ngModel)]="assessment.assessmentProcedure.occurTime" rows="5"
                                   nbInput fullWidth shape="round"
                                   required="true"
                                   placeholder="Describe how long it will take here" readonly></textarea>
                        <nb-checkbox [checked]="verifyProcedureState(question.key)"
                                     (checkedChange)="checkProcedureQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>

                      <br>
                      <hr class="solid">
                    </div>
                    <div class="container col-lg-12">
                      <div [formGroup]="form" class="col-lg-12 bottom-margin" *ngIf="parentQuestion.key === 'PR-19'">
                        <form class='container mt-3' formArrayName="steps">
                          <section *ngFor='let step of steps.controls; let i = index;' [formGroupName]="i">
                            <div class='row col-lg-12'>
                              <label>Step Title:</label>
                              <textarea nbInput class='display-next' style="margin-bottom: 10px"
                                        id='input-step-name'
                                        name='step-name'
                                        placeholder='Step title'
                                        fullWidth
                                        shape="round"
                                        formControlName="name"></textarea>
                              <label>Step Description:</label>
                              <textarea nbInput class='display-next'
                                        id='input-step-description'
                                        name='step-description'
                                        placeholder='Step description'
                                        fullWidth
                                        shape="round"
                                        formControlName="description"></textarea>
                              <nb-icon nbButton status="danger" class="display-next" icon="minus-circle-outline"
                                       (click)="open(deleteStepDialog)"></nb-icon>
                              <ng-template #deleteStepDialog let-data let-ref="dialogRef">
                                <nb-card accent="warning">
                                  <nb-card-body>Do you really want to remove the step?</nb-card-body>
                                  <nb-card-footer class="text-center">
                                    <button nbButton status="success"
                                            (click)="removeSteps(i);ref.close();">YES
                                    </button>
                                    <button nbButton status="danger" class="button-space" (click)="ref.close()">NO
                                    </button>
                                  </nb-card-footer>
                                </nb-card>
                              </ng-template>
                            </div>
                            <hr class="solid">
                          </section>
                        </form>
                        <button nbButton ghost shape='round' size='tiny' status='success' style="margin-bottom: 10px"
                                (click)='addSteps()' disabled>
                          <nb-icon icon="plus-circle-outline"></nb-icon>
                          Add Step
                        </button>
                        <nb-checkbox [checked]="verifyProcedureState(parentQuestion.key)"
                                     (checkedChange)="checkProcedureQuestion($event, parentQuestion.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div class="col-lg-12 bottom-margin" *ngIf="parentQuestion.key === 'PR-20'">
                        <nb-select placeholder="Not Selected" style="padding-left: 10px"
                                   [(selected)]="assessment.assessmentProcedure.questionsAllowed">
                          <nb-option *ngFor="let option of genericSelectOptions.options" [value]="option.value"
                                     disabled="true">{{ option.label }}</nb-option>
                        </nb-select>
                        <nb-checkbox [checked]="verifyProcedureState(parentQuestion.key)"
                                     (checkedChange)="checkProcedureQuestion($event, parentQuestion.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div class="col-lg-12 bottom-margin" *ngIf="parentQuestion.key === 'PR-21'">
                        <nb-radio-group disabled class="row bottom-margin"
                                        [(ngModel)]="assessment.assessmentProcedure.isPilotAssessment">
                          <nb-radio
                            *ngFor="let option of genericSelectOptions.options"
                            [value]="option.value">
                            {{ option.label }}
                          </nb-radio>
                        </nb-radio-group>
                        <div *ngIf="!isNullOrUndefinedOrFalse(assessment.assessmentProcedure.isPilotAssessment)">
                          <label>Description:</label>
                          <textarea style="padding-left: 10px"
                                    [(ngModel)]="assessment.assessmentProcedure.pilotDescription" rows="5"
                                    nbInput fullWidth shape="round"
                                    required="true"
                                    placeholder="Describe how will be conducted here" readonly
                                    [hidden]="!assessment.assessmentProcedure.isPilotAssessment"></textarea>
                        </div>
                        <nb-checkbox [checked]="verifyProcedureState(parentQuestion.key)"
                                     (checkedChange)="checkProcedureQuestion($event, parentQuestion.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
          <nb-accordion-item (click)="onClickApplication(categories.data.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.data.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button (click)="onEditData()" class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.data.acronym).parentQuestions; let i = index;">
                    <div class="col-lg-12 row">
                      <h4 class="bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
                        <nb-icon *ngIf="!isNullOrUndefined(parentQuestion.instruction)"
                                 icon="info-outline" class="button-space"
                                 [nbTooltip]="parentQuestion.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </h4>
                    </div>
                    <div class="container col-lg-12">
                      <div *ngIf="parentQuestion.key === 'DT-22'">
                        <textarea style="padding-left: 10px"
                                  [(ngModel)]="assessment.assessmentData.dataCollectionProcedure" rows="5"
                                  nbInput fullWidth shape="round"
                                  placeholder="Describe the data collection procedure here" readonly></textarea>
                        <nb-checkbox [checked]="verifyDataState(parentQuestion.key)"
                                     (checkedChange)="checkDataQuestion($event, parentQuestion.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div *ngIf="parentQuestion.key === 'DT-23'">
                        <label>Description:</label>
                        <textarea style="padding-left: 10px"
                                  [(ngModel)]="assessment.assessmentData.analysisDescription" rows="5"
                                  nbInput fullWidth shape="round"
                                  placeholder="Describe how it will be analyzed here" readonly></textarea>
                        <nb-checkbox [checked]="verifyDataState(parentQuestion.key)"
                                     (checkedChange)="checkDataQuestion($event, parentQuestion.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div class="col-lg-12 bottom-margin" *ngIf="parentQuestion.key === 'DT-24'">
                        <nb-radio-group disabled class="row bottom-margin"
                                        [(ngModel)]="assessment.assessmentData.statisticalMethods">
                          <nb-radio
                            *ngFor="let option of genericSelectOptions.options"
                            [value]="option.value">
                            {{ option.label }}
                          </nb-radio>
                        </nb-radio-group>
                        <div *ngIf="!isNullOrUndefinedOrFalse(assessment.assessmentData.statisticalMethods)">
                          <label>Description:</label>
                          <textarea style="padding-left: 10px"
                                    [(ngModel)]="assessment.assessmentData.statisticalMethodsDescription" rows="5"
                                    nbInput fullWidth shape="round"
                                    required="true"
                                    placeholder="Describe how will be conducted here" readonly
                                    [hidden]="!assessment.assessmentData.statisticalMethods"></textarea>
                        </div>
                        <nb-checkbox [checked]="verifyDataState(parentQuestion.key)"
                                     (checkedChange)="checkDataQuestion($event, parentQuestion.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
          <nb-accordion-item (click)="onClickApplication(categories.threats.acronym)">
            <nb-accordion-item-header style="background-color: #d9d9d9;color: #1a1f33">
              {{getCharacterizationQuestionsObject(categories.threats.acronym).section}}
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <div class="container">
                <nb-card>
                  <nb-card-header style="background-color: #206ea1">
                    <label><b>Section Progress</b></label>
                  </nb-card-header>
                  <nb-card-body class="example-items-col">
                    <div class="row col-lg-12 bottom-margin">
                      <nb-progress-bar class="col-lg-8 vertical-center" fullWidth [value]="questionsPercentage"
                                       [status]="getPercentageColor()"
                                       [displayValue]="true"></nb-progress-bar>
                      <button (click)="onEditThreat()" class="fa-pull-right padding-right" style="margin-left:5px" size="medium" nbButton ghost
                              status="success">
                        <nb-icon icon="edit-2-outline"></nb-icon>
                        EDIT SECTION
                      </button>
                    </div>
                  </nb-card-body>
                </nb-card>
                <div class="col-lg-12 bottom-margin">
                  <div
                    *ngFor="let parentQuestion of getCharacterizationQuestionsObject(categories.threats.acronym).parentQuestions; let i = index;">
                    <div class="col-lg-12 row">
                      <h4 class="bottom-margin padding-right"><b>{{parentQuestion.title}}</b>
                        <nb-icon *ngIf="!isNullOrUndefined(parentQuestion.instruction)"
                                 icon="info-outline" class="button-space"
                                 [nbTooltip]="parentQuestion.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </h4>
                    </div>
                    <div *ngFor="let question of parentQuestion.questions" style="padding-left: 10px"
                         class="container col-lg-12">
                      <label class="col-lg-12"><b>{{question.title}}</b>{{question.subTitle}}
                        <nb-icon *ngIf="!isNullOrUndefined(question.instruction)"
                                 icon="info-outline" class="button-space"
                                 [nbTooltip]="question.instruction"
                                 nbTooltipPlacement="right"
                                 nbTooltipStatus="warning" nbButton status="warning"></nb-icon>
                      </label>
                      <div [formGroup]="form" class="col-lg-12 bottom-margin" *ngIf="question.key === 'TH-25-1'">
                        <form class='container mt-3' formArrayName="threats">
                          <section *ngFor='let threat of threats.controls; let i = index;' [formGroupName]="i">
                            <div class='row col-lg-12'>
                              <textarea nbInput class='display-next' style="margin-bottom: 10px"
                                        id='input-threat'
                                        name='threat'
                                        [placeholder]="question.placeholder"
                                        fullWidth
                                        shape="round"
                                        formControlName="threat"></textarea>
                              <nb-icon nbButton status="danger" class="display-next" icon="minus-circle-outline"
                                       (click)="open(deleteTreatDialog)"></nb-icon>
                              <ng-template #deleteTreatDialog let-data let-ref="dialogRef">
                                <nb-card accent="warning">
                                  <nb-card-body>Do you really want to remove the threat?</nb-card-body>
                                  <nb-card-footer class="text-center">
                                    <button nbButton status="success"
                                            (click)="removeThreat(i);ref.close();">YES
                                    </button>
                                    <button nbButton status="danger" class="button-space" (click)="ref.close()">NO
                                    </button>
                                  </nb-card-footer>
                                </nb-card>
                              </ng-template>
                            </div>
                            <hr class="solid">
                          </section>
                        </form>
                        <button nbButton ghost shape='round' size='tiny' status='success' style="margin-bottom: 10px"
                                (click)='addThreats()' disabled>
                          <nb-icon icon="plus-circle-outline"></nb-icon>
                          Add Threat
                        </button>
                        <nb-checkbox [checked]="verifyThreatState(question.key)"
                                     (checkedChange)="checkThreatQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div *ngIf="question.key === 'TH-25-2'">
                        <textarea style="padding-left: 10px"
                                  [(ngModel)]="assessment.assessmentThreat.controlMeasure" rows="5"
                                  nbInput fullWidth shape="round"
                                  [placeholder]="question.placeholder" readonly></textarea>
                        <nb-checkbox [checked]="verifyThreatState(question.key)"
                                     (checkedChange)="checkThreatQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div [formGroup]="form" class="col-lg-12 bottom-margin" *ngIf="question.key === 'TH-25-3'">
                        <form class='container mt-3' formArrayName="limitations">
                          <section *ngFor='let limitation of limitations.controls; let i = index;' [formGroupName]="i">
                            <div class='row col-lg-12'>
                              <textarea nbInput class='display-next' style="margin-bottom: 10px"
                                        id='input-limitation'
                                        name='limitation'
                                        [placeholder]="question.placeholder"
                                        fullWidth
                                        shape="round"
                                        formControlName="limitation"></textarea>
                              <nb-icon nbButton status="danger" class="display-next" icon="minus-circle-outline"
                                       (click)="open(deleteTreatDialog)"></nb-icon>
                              <ng-template #deleteTreatDialog let-data let-ref="dialogRef">
                                <nb-card accent="warning">
                                  <nb-card-body>Do you really want to remove the threat?</nb-card-body>
                                  <nb-card-footer class="text-center">
                                    <button nbButton status="success"
                                            (click)="removeLimitation(i);ref.close();">YES
                                    </button>
                                    <button nbButton status="danger" class="button-space" (click)="ref.close()">NO
                                    </button>
                                  </nb-card-footer>
                                </nb-card>
                              </ng-template>
                            </div>
                            <hr class="solid">
                          </section>
                        </form>
                        <button nbButton ghost shape='round' size='tiny' status='success' style="margin-bottom: 10px"
                                (click)='addLimitation()' disabled>
                          <nb-icon icon="plus-circle-outline"></nb-icon>
                          Add Limitation
                        </button>
                        <nb-checkbox [checked]="verifyThreatState(question.key)"
                                     (checkedChange)="checkThreatQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div class="col-lg-12 bottom-margin" *ngIf="question.key === 'TH-25-4'">
                        <nb-radio-group disabled class="row bottom-margin"
                                        [(ngModel)]="assessment.assessmentThreat.ethicalAspectsDefined">
                          <nb-radio
                            *ngFor="let option of genericSelectOptions.options"
                            [value]="option.value">
                            {{ option.label }}
                          </nb-radio>
                        </nb-radio-group>
                        <div *ngIf="!isNullOrUndefinedOrFalse(assessment.assessmentThreat.ethicalAspectsDefined)">
                          <label>Description:</label>
                          <textarea style="padding-left: 10px"
                                    [(ngModel)]="assessment.assessmentThreat.ethicalAspectsDescription" rows="5"
                                    nbInput fullWidth shape="round"
                                    required="true"
                                    [placeholder]="question.placeholder" readonly
                                    [hidden]="!assessment.assessmentThreat.ethicalAspectsDefined"></textarea>
                        </div>
                        <nb-checkbox [checked]="verifyThreatState(question.key)"
                                     (checkedChange)="checkThreatQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <div *ngIf="question.key === 'TH-25-5'">
                        <textarea style="padding-left: 10px"
                                  [(ngModel)]="assessment.assessmentThreat.biasDescription" rows="5"
                                  nbInput fullWidth shape="round"
                                  [placeholder]="question.placeholder" readonly></textarea>
                        <nb-checkbox [checked]="verifyThreatState(question.key)"
                                     (checkedChange)="checkThreatQuestion($event, question.key)"
                                     style="padding-left: 20px; padding-top: 10px"
                                     status="primary" disabled="true" class="padding-right">Done
                        </nb-checkbox>
                      </div>
                      <br>
                      <hr class="solid">
                    </div>
                    <div class="container col-lg-12">
                    </div>
                  </div>
                </div>
              </div>
            </nb-accordion-item-body>
          </nb-accordion-item>
        </nb-accordion>
      </nb-card-body>
      <nb-card-footer>
        <div>
          <button nbButton class="padding-right" [disabled]="isPlanNotDone()" status="success">
            <b>SUBMIT</b>
          </button>
        </div>
      </nb-card-footer>
    </nb-card>
  </div>
</div>


